<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PARNIKA - Professional Dashboard </title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #f4f9ff;
      color: #0a3d62;
    }
    header {
      background: linear-gradient(90deg, #0a3d62, #3498db);
      color: white;
      padding: 16px 20px;
      text-align: center;
      font-size: 22px;
      font-weight: 600;
      letter-spacing: 1px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }
    .demo-badge {
      position: absolute;
      right: 18px;
      top: 12px;
      background: rgba(255,255,255,0.15);
      color: #fff;
      padding: 6px 12px;
      border-radius: 14px;
      font-size: 13px;
      backdrop-filter: blur(4px);
    }

    .time-badge {
      position: absolute;
      right: 18px;
      bottom: 8px;
      background: rgba(255,255,255,0.08);
      color: #fff;
      padding: 4px 10px;
      border-radius: 10px;
      font-size: 13px;
      animation: blink 1s step-end infinite;
    }

    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
    }
    .controls {
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:12px;
      justify-content: space-between;
    }
    .left-controls { display:flex; gap:12px; align-items:center; }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 18px;
    }
    .card {
      background: white;
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      transition: 0.3s;
      position: relative;
    }
    .pulse {
      animation: pulseGlow 1.2s infinite;
    }
    @keyframes pulseGlow {
      0% { box-shadow: 0 0 0 0 rgba(231,76,60,0.25); }
      70% { box-shadow: 0 0 0 12px rgba(231,76,60,0); }
      100% { box-shadow: 0 0 0 0 rgba(231,76,60,0); }
    }

    .card.alert {
      border: 2px solid #e74c3c;
      animation: blinkBorder 1s infinite;
    }
    @keyframes blinkBorder {
      0%, 50%, 100% { border-color: #e74c3c; }
      25%, 75% { border-color: #fff; }
    }
    .card h3 { font-size: 16px; color: #555; margin-bottom: 10px; }
    .card p { font-size: 28px; font-weight: bold; margin: 0; color: #0a3d62; }

    .charts { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
    .chart-box { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
    @media (max-width: 900px) { .charts { grid-template-columns: 1fr; } }

    .back-btn {
      position: absolute;
      left: 18px;
      top: 12px;
      background: rgba(255,255,255,0.12);
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      backdrop-filter: blur(4px);
    }
    .back-btn:hover { background: rgba(255,255,255,0.2); }

    .switch {
      display:inline-flex; align-items:center; gap:8px; font-size:14px;
    }
    .switch input { display:none; }
    .slider {
      width:48px; height:26px; background:#ddd; border-radius:20px; position:relative; cursor:pointer;
      transition: background .2s;
    }
    .knob { position:absolute; width:20px; height:20px; background:white; border-radius:50%; top:3px; left:3px; transition: left .2s; }
    .switch input:checked + .slider { background: #34b3ff; }
    .switch input:checked + .slider .knob { left:25px; }

    .export-btn { background:#2b6777; color:#fff; padding:8px 12px; border-radius:8px; text-decoration:none; cursor:pointer; }
    .export-btn:hover { background:#1f4f5a; }

    .footer-note { text-align:center; font-size:0.85rem; color:#4b6b85; margin-top: 14px; }
  </style>
</head>
<body>
  <header>
    <a href="frontpage.html" class="back-btn">‚¨Ö Back</a>
    
    Parnika Personal Dashboard
    <span class="demo-badge"></span>
    <div class="time-badge" id="header-time">--:--:--</div>
  </header>

  <div class="container">
    <div class="controls">
      <div class="left-controls">
        <label class="switch">
          <input type="checkbox" id="modeToggle" checked>
          <span class="slider"><span class="knob"></span></span>
        </label>
        <div style="font-size:14px">Mode: <strong id="modeLabel">Simulated</strong></div>
      </div>
      <div>
        <button class="export-btn" id="exportBtn">Export CSV</button>
      </div>
    </div>

    <div class="cards">
      <div class="card pulse" id="hrCard"><h3>‚ù§Ô∏è Heart Rate</h3><p id="hrValue">82 BPM</p></div>
      <div class="card" id="oxyCard"><h3>ü©∏ Oxygen Level</h3><p id="oxyValue">97 %</p></div>
      <div class="card"><h3>üëü Steps</h3><p id="stepsValue">5400</p></div>
      <div class="card"><h3>üò¥ Sleep</h3><p id="sleepValue">7 hrs</p></div>
    </div>

    <div class="charts">
      <div class="chart-box">
        <h3 style="text-align:center;">Heart Rate (BPM)</h3>
        <canvas id="heartRateChart"></canvas>
      </div>
      <div class="chart-box">
        <h3 style="text-align:center;">Oxygen Level (%)</h3>
        <canvas id="oxygenChart"></canvas>
      </div>
      <div class="chart-box">
        <h3 style="text-align:center;">Steps</h3>
        <canvas id="stepsChart"></canvas>
      </div>
      <div class="chart-box">
        <h3 style="text-align:center;">Sleep (hrs)</h3>
        <canvas id="sleepChart"></canvas>
      </div>
    </div>

    
  </div>

<script>
  let labels = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
  let heartRate = [80, 82, 85, 90, 88, 84, 76];
  let oxygen = [97, 96, 98, 95, 97, 96, 98];
  let steps = [4000, 5200, 6000, 7500, 6800, 7200, 8100];
  let sleep = [6, 7.5, 6.8, 8, 7, 7.2, 6.5];

  function refreshCards() {
    document.getElementById("hrValue").textContent = Math.round(heartRate[heartRate.length-1]) + " BPM";
    document.getElementById("oxyValue").textContent = Math.round(oxygen[oxygen.length-1]) + " %";
    document.getElementById("stepsValue").textContent = steps[steps.length-1];
    document.getElementById("sleepValue").textContent = sleep[sleep.length-1] + " hrs";
  }
  refreshCards();

  const HR_LOW = 50, HR_HIGH = 120, OXY_LOW = 90;

  function checkAlerts() {
    const hrLast = heartRate[heartRate.length-1];
    const oxyLast = oxygen[oxygen.length-1];

    if (hrLast < HR_LOW || hrLast > HR_HIGH) document.getElementById("hrCard").classList.add("alert"); else document.getElementById("hrCard").classList.remove("alert");
    if (oxyLast < OXY_LOW) document.getElementById("oxyCard").classList.add("alert"); else document.getElementById("oxyCard").classList.remove("alert");
  }

  function createChart(ctxId, label, data, color, beginAtZero=false) {
    return new Chart(document.getElementById(ctxId), {
      type: "line",
      data: { labels, datasets: [{ label, data, borderColor: color, backgroundColor: color + "33", fill: true, tension: 0.4, pointBackgroundColor: color, pointRadius: 3 }] },
      options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: beginAtZero } } }
    });
  }

  const hrChart = createChart("heartRateChart","BPM", heartRate, "#e74c3c");
  const oxyChart = createChart("oxygenChart","%", oxygen, "#3498db");
  const stepsChart = createChart("stepsChart","Steps", steps, "#f39c12", true);
  const sleepChart = createChart("sleepChart","Hours", sleep, "#9b59b6");

  const UPDATE_INTERVAL = 60000; // 1 minute
  const MAX_POINTS = 20;
  let simInterval = null;

  function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }

  function simulateNext() {
    const lastSteps = steps[steps.length - 1] || 0;
    const newSteps = lastSteps + 10;
    steps.push(newSteps);

    const lastHR = heartRate[heartRate.length - 1];
    let hrDelta = (Math.random() * 6) - 3;
    if (Math.random() < 0.08) hrDelta += (Math.random() < 0.5 ? -6 : 6);
    let newHR = clamp(Math.round(lastHR + hrDelta), 45, 140);
    heartRate.push(newHR);

    const lastOxy = oxygen[oxygen.length - 1];
    let oxyDelta = (Math.random() * 1) - 0.5;
    if (Math.random() < 0.05) oxyDelta -= 0.6;
    let newOxy = clamp(Math.round((lastOxy + oxyDelta) * 10) / 10, 85, 100);
    oxygen.push(newOxy);

    const now = new Date();
    const hh = String(now.getHours()).padStart(2,'0');
    const mm = String(now.getMinutes()).padStart(2,'0');
    const ss = String(now.getSeconds()).padStart(2,'0');
    labels.push(hh + ":" + mm + ":" + ss);

    if (labels.length > MAX_POINTS) labels.shift();
    if (heartRate.length > MAX_POINTS) heartRate.shift();
    if (oxygen.length > MAX_POINTS) oxygen.shift();
    if (steps.length > MAX_POINTS) steps.shift();

    hrChart.data.labels = labels; hrChart.data.datasets[0].data = heartRate; hrChart.update();
    oxyChart.data.labels = labels; oxyChart.data.datasets[0].data = oxygen; oxyChart.update();
    stepsChart.data.labels = labels; stepsChart.data.datasets[0].data = steps; stepsChart.update();

    refreshCards(); checkAlerts();
  }

  function startSimulation() {
    if (simInterval) clearInterval(simInterval);
    simInterval = setInterval(simulateNext, UPDATE_INTERVAL);
    document.getElementById('hrCard').classList.add('pulse');
  }
  function stopSimulation() {
    if (simInterval) { clearInterval(simInterval); simInterval = null; }
    document.getElementById('hrCard').classList.remove('pulse');
  }

  startSimulation();

  const modeToggle = document.getElementById('modeToggle');
  const modeLabel = document.getElementById('modeLabel');
  modeToggle.addEventListener('change', () => {
    if (modeToggle.checked) {
      modeLabel.textContent = 'Simulated'; startSimulation();
    } else {
      modeLabel.textContent = 'Live'; stopSimulation();
      console.info('Switched to Live mode ‚Äî no live feed connected in demo.');
    }
  });

  function updateHeaderTime() {
    const now = new Date();
    const timeStr = now.toLocaleTimeString();
    document.getElementById('header-time').textContent = timeStr;
  }
  setInterval(updateHeaderTime, 1000); updateHeaderTime();

  function exportCSV() {
    const rows = [];
    rows.push(['timestamp','heartRate','oxygen','steps'].join(','));
    const len = labels.length;
    for (let i=0;i<len;i++){
      const r = [labels[i], heartRate[i] !== undefined ? heartRate[i] : '', oxygen[i] !== undefined ? oxygen[i] : '', steps[i] !== undefined ? steps[i] : ''];
      rows.push(r.join(','));
    }
    const csvContent = rows.join('\n');
    const blob = new Blob([csvContent], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'parnika_demo_data.csv';
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  }
  document.getElementById('exportBtn').addEventListener('click', exportCSV);

  checkAlerts();
</script>
</body>
</html>
